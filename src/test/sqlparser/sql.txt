DECLARE @NEWID VARCHAR(50) 
DECLARE @MATERIALSTOCKID VARCHAR(50)
DECLARE @MANAGEMETHOD INT
SET @NEWID=NEWID()
SET @MANAGEMETHOD=0
SET @MATERIALSTOCKID=''


insert into Wms_Materialoutstorage (STORAGEAREAID, id) values('149597e0d07d4402be04c5298fb2096d', 'zs')


/*找到库存ID，插入出库小号货位数据*/
select @MANAGEMETHOD = MANAGEMETHOD from MDM_MATERIALINFO where ID = 'ea1d12040bd84b8ebafff3e6553dace0'  --0a145782df67490b8c8c52070613f8fc null
select @MATERIALSTOCKID = ID from WMS_MATERIALSTOCK														 --	ea1d12040bd84b8ebafff3e6553dace0  1
where STORAGEAREAID = (select STORAGEAREAID from WMS_MATERIALOUTSTORAGE where ID = 'zs')
and MATERIALID = 'ea1d12040bd84b8ebafff3e6553dace0'
and BARCODE = 'CP1-001'
and STOCKNUMBER>0
and RECORDSTATUS>1




/*插入出库细表数据*/
INSERT INTO WMS_MATERIALOUTSTORAGEDETAILS
(OUTSTORAGERECORDID,MATERIALID,BARCODE,SERIALNUMBER,BATCHNUMBER,
SIZE,OUTSTORAGENUMBER,REMARK,SORTCODE,DELETEFLAG,
ID,CUSTOMER_ID, PROJECT_ID,CREATE_DATE, LAST_UPDATE_DATE,
CREATE_USER_ID, LAST_UPDATE_USER_ID)
VALUES 
(1,'ea1d12040bd84b8ebafff3e6553dace0','CP1-001',null,null,
null,1,null,0,1,
@NEWID,'unknow','unknow',GETDATE(),GETDATE(),
'unknow','unknow');

select @MANAGEMETHOD

/*单个管理插入对应的库位数据，@MANAGEMETHOD=1单个管理，2批次管理*/
IF(@MANAGEMETHOD = 1)
BEGIN
	insert into WMS_OUTMATERIALPLACEDETAILS
	(MATERIALOUTSTORAGEID,OUTSTORAGEDETAILSID,GOODSPLACEID,SINGLECODE,BARCODE,NUMBER,
	ID,CUSTOMER_ID, PROJECT_ID,CREATE_DATE, LAST_UPDATE_DATE,
	CREATE_USER_ID, LAST_UPDATE_USER_ID)
	select  1, @NEWID,GOODSPLACEID,SINGLECODE,BARCODE,1,
	NEWID(),'unknow','unknow',GETDATE(),GETDATE(),
	'unknow','unknow'
	from WMS_STOCKMATERIALPLACEDETAILS 
	where MATERIALSTOCKID = @MATERIALSTOCKID ;
END